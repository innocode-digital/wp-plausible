!function(t,e,l,r){e.domReady(()=>{const{api:i,charts:s}=t,c=e=>new Intl.NumberFormat(document.documentElement.lang||"en-US").format(e),n=e=>new Date(e).toLocaleDateString(document.documentElement.lang||"en-US",{month:"short",day:"numeric",year:"numeric"}),d=e=>{var t=new Date(1e3*e).toISOString();return e<3600?t.substring(14,19):t.substring(11,16)},u=e=>{e=document.getElementById("innstats-widget-"+e).nextElementSibling;e&&e.remove()},a=e=>{[...document.getElementById("innstats-section-"+e).querySelectorAll(".innstats-widget > .inside")].forEach(e=>{var t;e=e,(t=document.createElement("span")).classList.add("spinner"),e.appendChild(t)})};var e=(e,t)=>{const n=document.getElementById("innstats-section-"+e);if(n){const i=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(t(n),i.unobserve(n))})});i.observe(n)}};e("general",()=>{a("general");var e=document.getElementById("innstats-widget-misc");const t=document.createElement("div"),r=document.createElement("dl"),o=document.createElement("div");t.classList.add("innstats-widget","innstats-widget_realtime-visitors"),r.classList.add("innstats-widget","innstats-widget_aggregate"),o.classList.add("innstats-widget","innstats-widget_top-countries"),e.appendChild(r),e.appendChild(t),e.appendChild(o),i.realtimeVisitors().then(e=>{t.innerHTML=`<span class="innstats-realtime-status innstats-realtime-status_online" aria-label="Online"></span> <span id="innstats-realtime-visitors">${e}</span> currently online`,u("misc")}),i.aggregate({metrics:["visitors","pageviews","bounce_rate","visit_duration"],compare:"previous_period"}).then(a=>{[["visitors","Unique visitors"],["pageviews","Total pageviews"],["visit_duration","Visit duration"],["bounce_rate","Bounce rate"]].forEach(([e,t])=>{var{value:n,change:i}=a[e],s=document.createElement("dt"),t=(s.innerHTML=t,r.appendChild(s),document.createElement("dd")),s=`<span id="innstats-${e}">${("visit_duration"===e?d:c)(n)}</span>`;t.innerHTML=s+("bounce_rate"===e?"%":"")+(i?` <span id="innstats-${e}-change" class="innstats-badge innstats-badge_${i<0?"danger":"success"}">${i}%</span>`:""),r.appendChild(t)}),u("misc")}),i.timeseries({metrics:["visitors","pageviews","bounce_rate","visit_duration"]}).then(e=>{s.lines(e.map(e=>({...e,timeseries:n(e.date)})),"timeseries",null,["visitors","pageviews"],{visitors:"Unique visitors",pageviews:"Total pageviews"}),s.line(e.map(e=>({...e,y:e.visit_duration,value:d(e.visit_duration),visit_duration:n(e.date)})),"visit_duration","Visit duration",e=>d(e)),s.line(e.map(e=>({...e,y:e.bounce_rate,value:e.bounce_rate+"%",bounce_rate:n(e.date)})),"bounce_rate","Bounce rate",e=>e+"%"),u("timeseries"),u("visit_duration"),u("bounce_rate")}),Promise.all([fetch("https://cdn.jsdelivr.net/npm/visionscarto-world-atlas@0.1.0/world/110m.json").then(e=>e.json()),fetch("https://cdn.jsdelivr.net/npm/i18n-iso-countries@7.5.0/codes.json").then(e=>e.json()),i.visit("country",{limit:100})]).then(([e,a,t])=>{const r=l.topojson.feature(e,e.objects.countries).features.filter(e=>"Antarctica"!==e.properties.name);s.choropleth(r.map(e=>({feature:e,country:e.properties.name,visitors:t.find(t=>e.id===a.find(([e])=>e===t.country)?.[2])?.visitors})),"country","Countries"),u("country"),o.innerHTML="<h4>Top Countries</h4><ul></ul>",t.slice(0,10).forEach(({country:t,visitors:e})=>{var n=document.createElement("li"),i=String.fromCodePoint(...t.toUpperCase().split("").map(e=>127397+e.charCodeAt(0))),s=r.find(e=>e.id===a.find(([e])=>e===t)?.[2])?.properties.name||t;n.innerHTML=`${i} ${s} <strong>${c(e)}</strong>`,o.querySelector("ul").appendChild(n),u("misc")})})}),e("top_pages",()=>{a("top_pages"),i.event("page").then(e=>{s.horizontalBar(e,"page","Popular"),u("page")});const n={entry_page:"Entry Pages",exit_page:"Exit Pages"};Object.keys(n).forEach(t=>{i.visit(t).then(e=>{s.horizontalBar(e,t,n[t]),u(t)})})}),e("top_sources",()=>{a("top_sources");const n={source:"Popular",utm_medium:"UTM Medium",utm_source:"UTM Source",utm_campaign:"UTM Campaign",utm_term:"UTM Term",utm_content:"UTM Content"};Object.keys(n).forEach(t=>{i.visit(t).then(e=>{s.horizontalBar(e,t,n[t]),u(t)})})}),e("devices_and_browsers",()=>{a("devices_and_browsers");const n={device:"Devices",browser:"Browsers",os:"Operating Systems",language:"Languages"};Object.keys(n).forEach(t=>{(["device","browser","os"].includes(t)?i.visit(t):i.custom(t)).then(e=>{s.pie(e,t,n[t]),u(t)})}),i.custom("device_pixel_ratio").then(e=>{e=e.sort((e,t)=>e.device_pixel_ratio-t.device_pixel_ratio);s.bar(e,"device_pixel_ratio","Retina","Device Pixel Ratio"),u("device_pixel_ratio")}),i.custom("ad_blocker",{limit:2}).then(e=>{s.bar(e.reverse(),"ad_blocker","Ad Blocker"),u("ad_blocker")})}),r&&r(document).on("heartbeat-send",()=>{i.realtimeVisitors().then(e=>{document.getElementById("innstats-realtime-visitors").innerHTML=e}),i.aggregate({metrics:["visitors","pageviews","bounce_rate","visit_duration"],compare:"previous_period"}).then(a=>{Object.keys(a).forEach(e=>{var{value:t,change:n}=a[e],i=document.getElementById("innstats-"+e),s=document.getElementById(`innstats-${e}-change`);i&&(i.innerHTML=("visit_duration"===e?d:c)(t)),n&&s&&(s.innerHTML=(0<n?"+":"")+n+"%",s.classList.remove("innstats-badge_success","innstats-badge_danger"),s.classList.add("innstats-badge_"+(0<n?"success":"danger")))})})})})}(window.innstats,window.wp,window.ChartGeo,window.jQuery);